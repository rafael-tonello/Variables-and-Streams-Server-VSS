#Project name. We use it sometimes
name: VarStreamServer
#main scripts of the project. When you call 'shu run' without arguments, all of these scripts are
#executed. Also, when you run 'shu build', all these scripts will be runned with you call the built
#script
main:
  - VarServerSHU.sh
#project packages. This list is used to restore .shu/packages folder when you call 'shu restore'
packages:
  - https://github.com/rafael-tonello/SHU.git#src/shellscript-fw/common as common --not-recursive
#project commands. You can call commands by using shu <command> [args]. You also can override SHU 
# default  #commands ('build', 'run', ...). When writing a command, do not forget to treat help 
#requests (-h, --help and help).
#Also, you command can receive, as a first argument, the string 'bashCompletion', That is SHI 
#trying get bash completions from your command. To generate bash completion, your script should
#print the completions to stdout (use spaces to separate the completions). Second argument is
#the string 'typed' by the user before pressing tab.
project-commands:
  build:
    bash-action: source ./shu/pcommands/build/build.sh
    description: build [--debug]. Build the project. If --debug options is passed, the build symbols will be added to the project. Otherwise, a 'production' binary will be build
  build-tests:
    bash-action: source ./shu/pcommands/build/buildTestsProject.sh
    description: Build the tests project (project inside folder 'tests'). The binary ./tests/build/tests will be generated (with debug symbols). If you need to clean the tests build, you can call 'shu build-tests --clean'
  new-version:
    bash-action: source ./shu/pcommands/apply-or-create-new-version.sh
    description: Creates a new version of the project. If the project is already in a version, it will apply the new version to the project
#Commands needed to run the project. When you call 'shu psysdeps check', all this commands will be
#checked
sysdepss:
  - cmd: curl
    info: Curl is needed for some http operations (apt install curl)
    check-command: command -v curl
  - cmd: go
    info: Go is needed to build some project dependencies (apt install golang)
    check-command: command -v go  
hooks:
  - when: after
    shu-command: pdeps restore
    cmd: source ./shu/hooks/shu/after-dep-restore-register-git-hooks.sh
  - when: after
    shu-command: pdeps restore
    cmd: source ./shu/hooks/shu/after-dep-restore-open-readme-md.sh
  - when: after
    shu-command: pdeps restore
    cmd: if [ $(go get && go mod tidy; echo $?) -eq 0 ]; then misc.PrintGreen "Go dependencies restored successfully\n"; else misc.PrintRed "Error restoring go dependencies\n"; fi
  - when: after
    shu-command: clean
    cmd: rm -rf ./build; misc.PrintYellow "Project cleaned. Run 'shu restore' to restore shu packages.\n"
project-properties:
  binary-name: vss
  build:
    additional-files-and-dirs:
      cpp:
        cpp-files:
          - ./.shu/packages/TCPServer/sources/TCPServer.cpp
          - ./.shu/packages/ThreadPool/ThreadPool.cpp
          - ./.shu/packages/PrefixTreeStorage/storages/memorystorage.cpp
          - ./.shu/packages/PrefixTreeStorage/storages/filestorage.cpp
          - ./.shu/packages/DependencyInjection/sources/dependencyInjectionManager.cpp
          - ./.shu/packages/KwWebServer/sources/KWTinyWebServer.cpp
          - ./.shu/packages/KwWebServer/sources/HttpData.cpp
          - ./.shu/packages/KwWebServer/sources/helpers/httpCodes.cpp
          - ./.shu/packages/KwWebServer/sources/helpers/KWWebServerRouter.cpp
          - ./.shu/packages/KwWebServer/sources/Workers/CookieParser.cpp
          - ./.shu/packages/KwWebServer/sources/Workers/HttpSession.cpp
          - ./.shu/packages/KwWebServer/sources/StringUtilFuncs.cpp
          - ./.shu/packages/KwWebServer/sources/SysLink.cpp
          - ./.shu/packages/libs.json_maker/sources/JSON.cpp
          - ./.shu/packages/Logger/sources/writers/LoggerFileWriter.cpp
          - ./.shu/packages/Logger/sources/writers/loggercommandcallwriter.cpp
          - ./.shu/packages/Logger/sources/writers/LoggerConsoleWriter.cpp
          - ./.shu/packages/Logger/sources/writers/LoggerLambdaWriter.cpp
          - ./.shu/packages/Logger/sources/ilogger.cpp
          - ./.shu/packages/Logger/sources/logger.cpp
          - ./.shu/packages/Logger/sources/common/loggerutils.cpp
          - ./.shu/packages/DynamicVar/sources/DynamicVar.cpp
        h-files:
          - ./.shu/packages/TCPServer/sources/TCPServer.h
          - ./.shu/packages/ThreadPool/ThreadPool.h
          - ./.shu/packages/PrefixTreeStorage/storages/memorystorage.h
          - ./.shu/packages/PrefixTreeStorage/storages/filestorage.h
          - ./.shu/packages/PrefixTreeStorage/prefixtree.h
          - ./.shu/packages/DependencyInjection/sources/dependencyInjectionManager.h
          - ./.shu/packages/KwWebServer/sources/HttpData.h
          - ./.shu/packages/KwWebServer/sources/helpers/KWWebServerRouter.h
          - ./.shu/packages/KwWebServer/sources/helpers/httpCodes.h
          - ./.shu/packages/KwWebServer/sources/helpers/WebServerObserverHelper.h
          - ./.shu/packages/KwWebServer/sources/SysLink.h
          - ./.shu/packages/KwWebServer/sources/Workers/HttpSession.h
          - ./.shu/packages/KwWebServer/sources/Workers/CookieParser.h
          - ./.shu/packages/KwWebServer/sources/httpRamCache.h
          - ./.shu/packages/KwWebServer/sources/IWorker.h
          - ./.shu/packages/KwWebServer/sources/KWTinyWebServer.h
          - ./.shu/packages/KwWebServer/sources/StringUtilFuncs.h
          - ./.shu/packages/libs.json_maker/sources/JSON.h
          - ./.shu/packages/Logger/sources/writers/LoggerLambdaWriter.h
          - ./.shu/packages/Logger/sources/writers/LoggerFileWriter.h
          - ./.shu/packages/Logger/sources/writers/loggercommandcallwriter.h
          - ./.shu/packages/Logger/sources/writers/LoggerConsoleWriter.h
          - ./.shu/packages/Logger/sources/ilogger.h
          - ./.shu/packages/Logger/sources/logger.h
          - ./.shu/packages/Logger/sources/common/loggerutils.h
          - ./.shu/packages/DynamicVar/sources/DynamicVar.h
        include-dirs:
          - ./.shu/packages/TCPServer/sources
          - ./.shu/packages/ThreadPool
          - ./.shu/packages/PrefixTreeStorage/storages
          - ./.shu/packages/PrefixTreeStorage
          - ./.shu/packages/DependencyInjection/sources
          - ./.shu/packages/KwWebServer/sources
          - ./.shu/packages/KwWebServer/sources/helpers
          - ./.shu/packages/KwWebServer/sources/Workers
          - ./.shu/packages/libs.json_maker/sources
          - ./.shu/packages/Logger/sources/writers
          - ./.shu/packages/Logger/sources
          - ./.shu/packages/Logger/sources/common
          - ./.shu/packages/DynamicVar/sources
    cc-flags: -c -pthread -std=c++2a -lssl -lcrypto -Wextra -Wuninitialized
    lk-flags: -pthread -std=c++2a -lssl -lcrypto
