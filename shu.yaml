#Project name. We use it sometimes
name: VarStreamServer
#main scripts of the project. When you call 'shu run' without arguments, all of these scripts are
#executed. Also, when you run 'shu build', all these scripts will be runned with you call the built
#script
main:
  - VarServerSHU.sh
#project packages. This list is used to restore .shu/packages folder when you call 'shu restore'
packages:
  - https://github.com/rafael-tonello/SHU.git#src/shellscript-fw/common as common --not-recursive
  - https://github.com/rafael-tonello/DynamicVar.git
  - https://github.com/rafael-tonello/libs.json_maker.git
  - https://github.com/rafael-tonello/DependencyInjection.git
  - https://github.com/rafael-tonello/Logger.git
  - https://github.com/rafael-tonello/TCPServer.git
  - https://github.com/rafael-tonello/ThreadPool.git
  - https://github.com/rafael-tonello/KwWebServer
  - https://github.com/rafael-tonello/PrefixTreeStorage#sources as PrefixTreeStorage
#project commands. You can call commands by using shu <command> [args]. You also can override SHU 
# default  #commands ('build', 'run', ...). When writing a command, do not forget to treat help 
#requests (-h, --help and help).
#Also, you command can receive, as a first argument, the string 'bashCompletion', That is SHI 
#trying get bash completions from your command. To generate bash completion, your script should
#print the completions to stdout (use spaces to separate the completions). Second argument is
#the string 'typed' by the user before pressing tab.
project-commands:
  touch:
    bash-action: source ./shu/pcommands/touch.sh
    description: Creates a new cpp class files. Using touch MyClass, the files myclas.cpp and myclass.h will be created with a empty class template
  build:
    bash-action: source ./shu/pcommands/build/build.sh
    description: build [--debug]. Build the project. If --debug options is passed, the build symbols will be added to the project. Otherwise, a 'production' binary will be build
  build-tests:
    bash-action: source ./shu/pcommands/build/buildTestsProject.sh
    description: Build the tests project (project inside folder 'tests'). The binary ./tests/build/tests will be generated (with debug symbols). If you need to clean the tests build, you can call 'shu build-tests --clean'
  scancppfiles:
    bash-action: source ./shu/pcommands/scancppfiles.sh
    description: scancppfiles <directory>. Scan .cpp, .cxx, .h and .hpp files in the <directory> and registers it in the shu.yaml files. Also registers these files directories as aditional include dirs to be used by cpp compiler
  rescancppfiles:
    bash-action: echo 'removing old entries of cpp files'; shu pprops remove 'build.additional-files-and-dirs.cpp'; shu scancppfiles "./.shu/"; echo "reescan done"
    description: "Rescan all cpp files and include folders from .shu/packages. WARNING: this command will entire rewrite the 'build.additional-files-and-dirs.cpp' section in shu.yaml. If you have added or removed entries manually, they will be lost"
  new-version:
    bash-action: source ./shu/pcommands/apply-or-create-new-version.sh
    description: Creates a new version of the project. If the project is already in a version, it will apply the new version to the project
#Commands needed to run the project. When you call 'shu psysdeps check', all this commands will be
#checked
sysdepss:
  - cmd: curl
    info: Curl is needed for some http operations (apt install curl)
    check-command: command -v curl
  - cmd: clang++
    info: clang++ is used to compile the project in release mode. Project can work well only with g++ (apt install clang)
    check-command: command -v clang++
  - cmd: g++
    info: g++ is used to compile the project in debug mode. Project can work well only with clang++ (apt install g++)
    check-command: command -v g++
  - cmd: openssl-dev
    info: Openssl is used by KwHttpserver to start a Https server (apt install libssl-dev)
    check-command: _f(){ if [ -f /usr/include/openssl/ssl.h ]; then return 0; else return 1; fi; }; _f
hooks:
  - when: after
    shu-command: pdeps get
    cmd: source ./shu/hooks/shu/after-dep-get-scan-cpp-files.sh
  - when: after
    shu-command: pdeps restore
    cmd: source ./shu/hooks/shu/after-dep-restore-register-git-hooks.sh
  - when: after
    shu-command: pdeps restore
    cmd: source ./shu/hooks/shu/after-dep-restore-open-readme-md.sh
  - when: after
    shu-command: clean
    cmd: source ./shu/hooks/shu/after-clean-clean-cpp-project.sh
project-properties:
  binary-name: vss
  build:
    additional-files-and-dirs:
      cpp:
        cpp-files:
          - ./.shu/packages/TCPServer/sources/TCPServer.cpp
          - ./.shu/packages/ThreadPool/ThreadPool.cpp
          - ./.shu/packages/PrefixTreeStorage/storages/memorystorage.cpp
          - ./.shu/packages/PrefixTreeStorage/storages/filestorage.cpp
          - ./.shu/packages/DependencyInjection/sources/dependencyInjectionManager.cpp
          - ./.shu/packages/KwWebServer/sources/KWTinyWebServer.cpp
          - ./.shu/packages/KwWebServer/sources/HttpData.cpp
          - ./.shu/packages/KwWebServer/sources/helpers/httpCodes.cpp
          - ./.shu/packages/KwWebServer/sources/helpers/KWWebServerRouter.cpp
          - ./.shu/packages/KwWebServer/sources/Workers/CookieParser.cpp
          - ./.shu/packages/KwWebServer/sources/Workers/HttpSession.cpp
          - ./.shu/packages/KwWebServer/sources/StringUtilFuncs.cpp
          - ./.shu/packages/KwWebServer/sources/SysLink.cpp
          - ./.shu/packages/libs.json_maker/sources/JSON.cpp
          - ./.shu/packages/Logger/sources/writers/LoggerFileWriter.cpp
          - ./.shu/packages/Logger/sources/writers/loggercommandcallwriter.cpp
          - ./.shu/packages/Logger/sources/writers/LoggerConsoleWriter.cpp
          - ./.shu/packages/Logger/sources/writers/LoggerLambdaWriter.cpp
          - ./.shu/packages/Logger/sources/ilogger.cpp
          - ./.shu/packages/Logger/sources/logger.cpp
          - ./.shu/packages/Logger/sources/common/loggerutils.cpp
          - ./.shu/packages/DynamicVar/sources/DynamicVar.cpp
        h-files:
          - ./.shu/packages/TCPServer/sources/TCPServer.h
          - ./.shu/packages/ThreadPool/ThreadPool.h
          - ./.shu/packages/PrefixTreeStorage/storages/memorystorage.h
          - ./.shu/packages/PrefixTreeStorage/storages/filestorage.h
          - ./.shu/packages/PrefixTreeStorage/prefixtree.h
          - ./.shu/packages/DependencyInjection/sources/dependencyInjectionManager.h
          - ./.shu/packages/KwWebServer/sources/HttpData.h
          - ./.shu/packages/KwWebServer/sources/helpers/KWWebServerRouter.h
          - ./.shu/packages/KwWebServer/sources/helpers/httpCodes.h
          - ./.shu/packages/KwWebServer/sources/helpers/WebServerObserverHelper.h
          - ./.shu/packages/KwWebServer/sources/SysLink.h
          - ./.shu/packages/KwWebServer/sources/Workers/HttpSession.h
          - ./.shu/packages/KwWebServer/sources/Workers/CookieParser.h
          - ./.shu/packages/KwWebServer/sources/httpRamCache.h
          - ./.shu/packages/KwWebServer/sources/IWorker.h
          - ./.shu/packages/KwWebServer/sources/KWTinyWebServer.h
          - ./.shu/packages/KwWebServer/sources/StringUtilFuncs.h
          - ./.shu/packages/libs.json_maker/sources/JSON.h
          - ./.shu/packages/Logger/sources/writers/LoggerLambdaWriter.h
          - ./.shu/packages/Logger/sources/writers/LoggerFileWriter.h
          - ./.shu/packages/Logger/sources/writers/loggercommandcallwriter.h
          - ./.shu/packages/Logger/sources/writers/LoggerConsoleWriter.h
          - ./.shu/packages/Logger/sources/ilogger.h
          - ./.shu/packages/Logger/sources/logger.h
          - ./.shu/packages/Logger/sources/common/loggerutils.h
          - ./.shu/packages/DynamicVar/sources/DynamicVar.h
        include-dirs:
          - ./.shu/packages/TCPServer/sources
          - ./.shu/packages/ThreadPool
          - ./.shu/packages/PrefixTreeStorage/storages
          - ./.shu/packages/PrefixTreeStorage
          - ./.shu/packages/DependencyInjection/sources
          - ./.shu/packages/KwWebServer/sources
          - ./.shu/packages/KwWebServer/sources/helpers
          - ./.shu/packages/KwWebServer/sources/Workers
          - ./.shu/packages/libs.json_maker/sources
          - ./.shu/packages/Logger/sources/writers
          - ./.shu/packages/Logger/sources
          - ./.shu/packages/Logger/sources/common
          - ./.shu/packages/DynamicVar/sources
    cc-flags: -c -pthread -std=c++2a -lssl -lcrypto
    lk-flags: -pthread -std=c++2a -lssl -lcrypto
